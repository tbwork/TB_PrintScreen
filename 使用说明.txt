WaveSoft截屏软件说明

目录：
1.	题外话	1
2.	软件特色	1
2.1	QQ截屏的几个问题	1
2.2	WaveSoft截屏软件特色	2
2.3	版本和展望	3
3.	使用说明	3
4.	致谢	4



Version: 1.0.0.0版
工作组：WaveSoft 微服软件
作者：汤波
TBWood
1.	题外话
其实在2010年10月份以前曾经做过一个截图软件，很简陋的一个截屏软件，也具有蒙版效果，但是继续跟着QQ截屏去对照就发现，再往下实现就几乎不可能呢，而且速度也在成倍的减慢。其原理就是一下子弹出多个窗体，一个做蒙版，一个做底片，一个做截图等等。后来我接着好几个星期就特别佩服QQ截屏的神奇。因为那个阶段在准备考研，就一直没有着手。直到考完研后，放假在家，我下定决心要弄个明白，我在网上找了很多模拟QQ截屏的，一运行，发现根本没法和QQ比，不说效率，就算是功能都差的很多。然后也下了很多专业的截屏软件，发现也都没法和QQ比，速度上就不是一个档次。这些都“加剧”了我揭开它的谜底的欲望。
刚开始，我尝试了各种方法，比如GDI+的若干方法。都失败了，GDI+的速度太慢了。据说DX的速度很快，于是我决定研究下“QQ截屏是不是DX做的”这个论题。然后我下了一个查看窗口的工具WindowView，好家伙，自从认识了这个家伙，我变开始了对QQ截屏的解剖。并不是因为这个工具有多神奇，而是我每次把假设和论题归结到这个窗体的范畴上，然后用WindowView进行验证。然后我惊奇的发现了QQ截屏的几个失误和bug（见第2部分）。
整个编程过程从1月20开始，实打实的从早到晚，到2月20号开学后就停止了，完成了几个主要技术难度教高的问题。让后一直忙毕业，然后一直到5月20才继续，陆陆续续到今天终于完成。总历时大概在1个半月左右。期间问题重重，比如如何快速擦除和重绘、如何让窗体在最前端、如何实现强大而有趣的文字输入编辑模块。

2.	软件特色

2.1	QQ截屏的几个问题

以下都是我过程中一点一滴思考和验证得出的。仅为称述，不存在损毁QQ形象的意思。
QQ截屏的一些问题和缺陷：
1.鼠标箭头拉动时，不能即时转变方向。
2.图片精度低，虽然这是为了加快聊天时的传输速度（非技术失误）。
3.见图片工具框和截图区域错位的bug。【原因:根据上个部分的1所说，MainPanel每两次或者若干次Move事件才移动一次，那么必然只要在这个间隔内的move移动，不会引起MainPanel移动，所以我想到了，用鼠标瞬间移动导致一次Move事件，(Move事件是覆盖式时间间隔触发的) 而每次Move截图区域都会移动，这样就会导致截图区域移动，而MainPanel不移动的现象】。处理方法：在MouseUp事件里，加上控件移动代码。这里的MainPanel就是截图时的工具框（画刷等）。
4.在屏幕右端 拉出一个宽 30素，高为屏幕高的矩形，那么工具条会遮掩信息框。
5.整个窗体上隐藏了一个按钮，没有任何作用，我想是不是QQ程序员用于调试时用的（因为move事件，中可以不引起窗体重绘的文字显示控件，一般会先想到button，label控件会引起窗体重绘），忘记删了。（影响不大，但很好玩，就提出来了）
6.还有一个就是 在快速编辑过程中的，无效操作也会被记录记录，导致回退时会发生明明没有画东西，却无法回退（回退四步）。无效操作就是，没有画任何东西。
7.在画矩形或者圆形的时候，如果把画笔宽度调宽一点，那么就会发现抖动现象
8.文字输入框，在快速移动时，跳到框外，这时输入框无法移动了。
9.文字输入框，不输入任何字符，然后重新点击文字按钮，那么变为可移动截图框状态，但是，却不能移动，这是个不可否认的缺陷。
10.在使用机器CPU繁忙时，点击文字输入框到截屏图片上，会发现输入框外框线不出现，这说明，QQ程序员只是在其点击到窗口上（MouseDown）时，写了画外框线代码。但其实，这个动作会还触发一个事件，那就是MouseMove，为什么？因为Memo显示后，鼠标从窗体焦点移动到了Memo的焦点，虽然在屏幕上没有移动，但其实已经触发了Form的MouseMove，应当在这个代码里也加上画外框的代码。
11.在用鼠标拖拉矩形框时，如果同时使用方向键，发现也可以移动，这时应当是不能移动的（再拉时会回到原来的起始点），因加以标志位判断。
12.在一些DX游戏中截屏时，跳出后发现，窗口变小，但是鼠标垫活动范围还是全屏。导致面板隐藏等情况。

2.2	WaveSoft截屏软件特色

该软件不但修复了以上QQ静态截屏存在的一些问题，而且提供了很多有趣的功能，给用户很多的接口用于调制这个软件。除了QQ静态截屏提供的功能外，本软件还有以下特色有趣的功能。
? 首先一个特色就是在画线条或者其他情况下的设置颜色参数的时候，会发现不是有限的集中颜色，而是使用了一个颜色表，里面含有无数种颜色。
? 在快速编辑中，还添加了画直线的功能。
?提供了对一次拷屏的多次截图，在截图界面右击，弹出菜单，选择“保存并继续截图”按钮，便可将现有截图框内的截图保存到截图列表，且截图界面不关闭，可以进行多次截图。方便用户对一副图的多个部分进行分别截图。
? 在对矩形和圆的编辑中，提供了填充与否的选项，用于画实心的图形。并且没有QQ中的抖动现象。
? 本软件特别适合的几个应用场景有：
   （1）一般静态截图和简单编辑。
        截图时，你可以使用小面板上的工具，对截图区域进行编辑。软件提供了“铅笔/画刷”“箭头”“椭圆（有填充选项）”“矩形（有填充选项）”“直线”“文字”6大功能。

   （2）做实验观测结果、写论文写实验报告等作业截图。
        如果需要把窗体隐藏后再截图，只需在设置里勾选“截图时隐藏主窗体”。每截一张图，将会自动拷贝到剪切板。这时如果你正在编辑WORD或者在聊QQ时，即可Ctrl+V复制到窗口里，非常的方便。

   （3）在玩游戏过程中，如war3（dota），星际等游戏截图。
        1.利用printscreen截全屏。为了避免截图完主窗体弹出，首先在设置里勾选“截图时隐藏主窗体”。这样，在我们游戏中如果有什么精彩的画面，即可按下printscreen，游戏结束后，便可在软件的截图列表中发现刚刚所截的图。
        2.实时截屏。比如您在玩植物大战僵尸、Dota、愤怒的小鸟等游戏时，你按下快捷键Ctrl+Shift+A进行截图，这时游戏将自动被最小化，且弹出的截屏编辑窗口将自动适应您的游戏的分辨率（比如War3的分辨率就经常变化），从而得到分辨率大小的截屏编辑窗口，并且修补了鼠标范围未限制的Bug（QQ截屏）。

2.3	版本和展望
现有版本为1.0.0.0。往后，我想继续扩展“影视播放器截屏”功能、屏幕录制功能。

3.	使用说明
3.1主要界面图示
 
主界面（by 木头截屏）

 
设置界面（by 木头截屏）

3.2 快捷键
Ctrl+Shift+A： 截屏。（QQ的Ctrl+Alt+A将被屏蔽）。
Ctrl+C：在主界面下Ctrl+C复制当前指向的图片。
Up 、Down 、Left、 Right方向键：在截图时调节微调截图位置。
ESC：在截图界面时按下，如果截图区域已经产生，则取消该区域，并退回灰图。如果截图区域未产生，则退出当次截图。
     在预览界面时按下，退出预览。
Alt+M：在截图界面按下，显示/隐藏工具面板。和右击弹出菜单里的“显示/隐藏工具面板(&M)”按钮相同。
Ctrl+Z：在编辑截图区域时，用于取消当次操作，返回上一步操作，和面板的“回退键”一致。

3.3 其他
  其他的除了和QQ静态截屏一致的功能外，还有很多简单易懂的功能都在各个控件上注明了，用鼠标悬停在软件的各个控件上，看看便知。

4.	致谢
软件也许做的还存在很多缺陷，希望大家包容，毕竟个人能力有限。在Wavesoft的第一个软件完成之际，首先要感谢的是我的父母，是他们给了我一个温暖幸福的家。然后要感谢的是过程中所有对我有过帮助的同学和朋友，感谢测试员张秀同学对我的软件做了专业的测试。最后感谢我自己，感谢自己在重重困难中坚持了下来，感谢自己对很细微的东西也不肯放过的较真精神。
如大家发现了运行时Bug，请组织好语言和bug产生条件，发到我的邮箱,或用其他方式告诉我，十分感谢。

联系方式:
主页：
  ?校内： http://renren.com/woailuotangbo 
  ?CSDN： http://hi.csdn.net/TBWood
电话：15850728544
邮箱：tttbbb222000@163.com
